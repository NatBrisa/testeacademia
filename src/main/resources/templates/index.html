<!DOCTYPE html>
<html lang="pt">
    <head>
        <title>Coordenadoria de Educação de Fartura</title>
        <meta charset="UTF-8">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <link href="/css/main.css" rel="stylesheet" type="text/css"/>
        <script src="/js/loadJson.js" type="text/javascript"></script>
    </head>
    <body>
        <header>
            <hgroup><h1>Coordenadoria de Educação de Fartura</h1><h2>Apresentação</h2></hgroup>
        </header>

        <nav>
            <a href="index.html">Apresentação</a>
            <a>Busca</a>
            <a href="login.html">Login</a>
            <a>Ajuda</a>
        </nav>

        <section>
                <h3>Busca Resumida</h3>

                <form name="form_busca" method="POST">
                    <ul onchange="loadTable()">
                        <li><label><input name="tipo" type="radio" value="Docente"/>Docente</label></li>
                        <li><label><input name="tipo" type="radio" value="Monitor"/>Monitor</label></li>
                        <li><label><input name="tipo" type="radio" value="ADI"/>ADI</label></li>
                    </ul>

                    <p><label>Nome: <input name="nome" type="text" value="" onchange="loadTable()"/></label>
                    <label>RG: <input name="rg" type="text" value="" onchange="loadTable()"/></label>
                    <label>CPF: <input name="cpf" type="text" value="" onchange="loadTable()"/></label></p>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>RG</th>
                                <th>CPF</th>
                            </tr>
                        </thead>
                        <tbody>
                        <script>
                            function loadTable() {
                            var tipo = document.forms["form_busca"]["tipo"].value;
                            if(tipo === ""){
                                return 0;
                            }
                            var nomen = document.forms["form_busca"]["nome"].value;
                            var rgn = document.forms["form_busca"]["rg"].value;
                            var cpfn = document.forms["form_busca"]["cpf"].value;
                            alert(nomen + rgn + cpfn + tipo);
                            
                            var results = loadBuscaSemBD();
                            window.console.log("Numero d Resultados: " + results.length);
                            
                            //Cria um novo registro
                            var novoResgistro = {
                                nome: nomen, 
                                rg: rgn, 
                                cpf: cpfn
                            };
                            
                            results[results.length] = novoResgistro;
                            alert(novoResgistro);
                            
                            
                            //Tabela
                            var tableBody = window.document.getElementsByTagName("table").item(0);
                            
                            //Linhas da tabela
                            var tableRows = document.getElementsByTagName("tr");
                            
                            //Apaga as linhas existentes
                            for(i=0; i<tableRows.length; i++) {
                                if(tableRows[i].parentNode === tableBody)
                                    tableBody.removeChild(tableRows[i]);
                            }
                            
                            //Popula a tabela com os resultados
                            for(i=0;i<results.length;i++) {
                                //Cria uma nova linha
                                var row = document.createElement("tr");
                                
                                //Coluna Nome
                                var col = document.createElement("td");
                                var node = document.createTextNode(results[i].nome);
                                col.appendChild(node);
                                
                                //Coluna RG
                                var col1 = document.createElement("td");
                                var node1 = document.createTextNode(results[i].rg);
                                col1.appendChild(node1);
                                
                                //Coluna CPF
                                var col2 = document.createElement("td");
                                var node2 = document.createTextNode(results[i].cpf);
                                col2.appendChild(node2);
                                
                                //Insere os elementos na tabela
                                tableBody.appendChild(row);
                                row.appendChild(col);
                                row.appendChild(col1);
                                row.appendChild(col2);
                            }
                            
                            return 1;
                        }     
                        </script>
                        </tbody>
                    </table>
                    
                    <input type="submit" value="Buscar" name="buscar" />
                </form>
        </section>
        <footer></footer>
    </body>
</html>
